import numpy as np
def Fourier_loss(y_pred, y_true):
  F_pred = np.fft.fftshift(np.fft.fft2(y_pred))
  F_true = np.fft.fftshift(np.fft.fft2(y_true))
  X, Y = np.shape(np.squeeze(y_pred))
  W = min(X,Y)//20
  F_pred = F_pred[(-W+X//2):W+X//2,-W+Y//2:W+Y//2]
  F_true = F_true[-W+X//2:W+X//2,-W+Y//2:W+Y//2]
  return np.mean(np.abs((F_pred-F_true))**2)

a, b = np.zeros([512, 512]), np.zeros([512, 512])
print(Fourier_loss(a,b))
